{"version":3,"sources":["webpack:///path---spring-graphql-security-5eecaf9e07bbb1ddcb13.js","webpack:///./.cache/json/spring-graphql-security.json"],"names":["webpackJsonp","378","module","exports","data","meImage","sizes","base64","aspectRatio","src","srcSet","meImageFull","site","siteMetadata","url","recentPosts","edges","node","excerpt","frontmatter","title","date","path","type","markdownRemark","html","label","author","image","publicURL","childImageSharp","pathContext"],"mappings":"AAAAA,cAAc,iBAERC,IACA,SAAUC,EAAQC,GCHxBD,EAAAC,SAAkBC,MAAQC,SAAWC,OAASC,OAAA,6zDAAyBC,YAAA,mBAAAC,IAAA,kEAAAC,OAAA,oNAAAJ,MAAA,oCAA8pEK,aAAgBL,OAASC,OAAA,66DAAyBC,YAAA,iBAAAC,IAAA,6DAAAC,OAAA,uQAAAJ,MAAA,oCAA2zEM,MAASC,cAAgBC,IAAA,qBAA0BC,aAAgBC,QAAUC,MAAQC,QAAA,0JAAAC,aAAmLC,MAAA,sCAAAC,KAAA,oBAAAC,KAAA,2BAAAC,KAAA,WAA6HN,MAAQC,QAAA,sJAAAC,aAA+KC,MAAA,uCAAAC,KAAA,kBAAAC,KAAA,oBAAAC,KAAA,WAAqHN,MAAQC,QAAA,sJAAAC,aAA+KC,MAAA,0CAAAC,KAAA,kBAAAC,KAAA,0BAAAC,KAAA,WAA8HN,MAAQC,QAAA,qJAAAC,aAA8KC,MAAA,UAAAC,KAAA,oBAAAC,KAAA,WAAAC,KAAA,YAAiFC,gBAAmBC,KAAA;AAA6p7EP,QAAA,mGAAAC,aAAgaE,KAAA,oBAAAC,KAAA,2BAAAF,MAAA,sCAAAM,OAAA,uIAAAC,OAAA,iBAAAJ,KAAA,OAAAK,OAA4SC,UAAA,wDAAAC,iBAAuFxB,OAASC,OAAA,qWAAyBC,YAAA,iBAAAC,IAAA,8DAAAC,OAAA,yMAAAJ,MAAA,wCAAyrByB","file":"path---spring-graphql-security-5eecaf9e07bbb1ddcb13.js","sourcesContent":["webpackJsonp([172168835046748],{\n\n/***/ 378:\n/***/ (function(module, exports) {\n\n\tmodule.exports = {\"data\":{\"meImage\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFC0lEQVQ4y2WUa0yTVxjHT4WMeAsOvABWLdCWtvYt9PLSFkovFCj0Qul6oUVHL/RCoWC5RlBaLkFAlCEoqCzsln1xyzKzLG6JHxaXLRnZB5eYLdtMFnQf9mH7sOgHtfQ8430VCdlJ3jwnJ///L8953uc5CL1aCkE+HS1qHmPr7HzMxLTp+KrWRlI9O+xhbp13+uoztvary0n0+NHvaMfq8Fnp6KiT7qLiOxPhvTYtf6GKKHgiPJELJcdyQFTC/NtYLRm89/nEPkpDFmfv2vJ/duvmNmwmEaSjz6mlMwMAhpo4+n0pKweYB/fD0dx9ac6R7DQ/PxuK8t+EclHhg+uzXSpKuxshxqYeWeSHt4GCAoQujceoLQ3USgo/OnnsAOQd2PO86ND+tFlYgLu1XDxUJ0i/TRa+OJ6zF/TykudLk2EhfbtTOobX7ULrf/y2DdUreHT6BjWhIrl5QBRkpw28fNyr48GcXYoXnCS+YpfhKw4SoiruM/aR/VCr4M5RHoKVm7Gjfv3tjagwN4s+JAXMcaeKC0Mm0YvZJglcc8nxvF0GSy453PBU4AUHiRc8yrSOlwd81uFf/1m7uYfytVqV2xkORJtQ0YFMGqiWFM51N0rg/FvSVLyahxfcClhtrYKrngoYtYhhtlmOl/0afKqCDULWwSe9p7V0a9Qr2IzXwPnpGFIRTBqokbFjXU1S8KtLUnpeAY5UsmHFVwEJsxjspcchqjsJS0Ed9mtLgOTlp4fabSWU75SlgrHj2k0KDg2sFh6zd1ul0GeWbNilHBwkC2HRJoOROgJCagIGLXJ8I1KTDukFYCxj/fXhxRj9eztdWsaj9Ve9+MWdD9AZ5Utgh6zo9KhDAZNOMpVsIPAFcxm+blfAsqdy81PilYAOViK1G2P2ckhoBT//6KrLonyX9KWbzf3wJfD+wzU0qBfSwD41rynpkMN0c/nGtJnAwzUn8aRFCvONJLzvrcKrbRq8HNJvXHAqYEwr+JbyhDQ5aLJavA2k1phDSbfNlKOSjDeI0mNOKQwbBDiu4eHhWiFMmsSw6FHCexEdzLSqXkw7lHDZVjlBe4yyzB31e/DoPjpXL0OmejZd2IBBlEw4JNCjK0lFyophQMyBoUoCksZSvNymSg87SRiwKFe/6fXlUvprrUZGT14Werz+cOc8+w1ldJYuM1kcqBU866nlQaJOiMdqCFh2q2DOrcBzPhVETeKn7jbPEUp7zqmjPT+t3dsJG7Eq6Gguzadr2VjBXW0kT0BYxU4lGkSQtEogbhKlovUiCFQTX1Oa8myUQc2x79BOFlqcT6DxsX56HzKX0/XoNAhjNnkxaARHU2YxC0wSFhjFLNxWxYUuveipN+D1U7oabQWdQCAcQhcvzaC7d+8glEz2ou7uICMcac3kIEQLepyalWg1H1qU7JRHUUxFuqmnjETaq5HA2UQS1n747gQ9uoMDb1yYGn/50AiE6H8r2hU8a1aJoVvH24gbCJzcnOlRqwxGDULsVQogFo+nklMzcKav75Ovvvx03+tHt7sz4+a716n379/M8yNxjs/vbuno8H/sbmnGfOZh6K/hYwp0sVkByQbhZu1k0BZux+cmJiHW278RiLSDLxj8s3+wL3b79q3drzPy+lp+cbpsaU+LC0KRIFhsTlzKKcZhJWtzhstw/+bYNVXJoNZogeiZHjw4ksRt0RhYbbZUs8cNXr8XItHw+uDZgb6rS4tZ/wHWLgJEUscfmAAAAABJRU5ErkJggg==\",\"aspectRatio\":1.0256410256410255,\"src\":\"/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-20c2d.png\",\"srcSet\":\"/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-4e92c.png 75w,\\n/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-93059.png 150w,\\n/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-20c2d.png 200w\",\"sizes\":\"(max-width: 200px) 100vw, 200px\"}},\"meImageFull\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFYUlEQVQ4y42UfWxaVRTAX5sav7LFj21u1kK/WOkHbWkp9FEoUFpKofDgUR7fH4/H5ygUSgstLfRj3dplm5tzc1GjWcwy/zf70yzqX5q4ZCZGs/iHxmjin0v8xw24R3jdWIzR7iYv59x7zvnde86792DYf4xZRS8rp0baGmoSADDjOB9XSHv6n/hoVELWRigF2DMN+SCHDbCoe14VtB+9w3vzFejnHikJ+S039rZCr7OwaVHDM8FMEwKM82JDY00X80/cGue9AeGxztI542CFxjtB3Ntys2ZrPdTUmGZmDwZOSnjszpzu1sN2Bf/ngr4fPnBJy1coSfltmwQUvc2/8QTtr9V8lKKOg09pkvIfay83RXWD3/plXbCjHyin1YLKNoWDU971u6Sv7XjNwyrvORiYV/U+1Ynhu2dMQ3BWJyxfd4yVP4pMwoZeeP/ykSPP1+x76v6DU972qrElHZ+tYZYYur5tHIBlKb/0jkVSvhIYh4JRcrFmyxhFjZco5f/DUukwK8OEhAXatQM8r7zzz/xEL+yQI5AyDv1YXWZtSw41m+5iJoXdu/fNP0GJZLSuh8J0o0QgaHwyp8ZO/mCRdIBX2oFik8K/cmtrU2z9rHNNubVVFnpqYeEpbHd3pa77Ar466Np7u0fnrKZzAUUvbBHCSlYjKC/FQpBayf8aDDFjT/zS2Ww9BhsexjAmxDyG+VlDMhVTOF3UF5SNfDA1owPrCA+WZoaQZkIFwUS67Pb5weV2Qiweu71aLLzFQpeX9qHbp/OsDEaC7EI8EZM7PS7weF1AkiYwkeby5LgMkQQBxByFSAtZg1U8fl85nkpDOpv7/sz584f27xtpwCRjKmxzc5mdf/3VzRc8fs99yumqBjke+mkPCoSCYK6CAkEGMcEACjB+5PR4wOnzo0R68WGusAErhYKdBcwQFlY63K7nanI+GfUGo1GwOpwlr88N4WgI+YLVjwmA1+8FX3WNCYWAcrmrG4XRqWSqnC1uwfJ6MV+vocFkYlM1EMZjbq/7JzocAavNVqEZGoWjEWRz2KG6IXjoAPgCDLiDUTBarFU9gJJL2dLa6V1IrRY/3j+hwcD+cpdl+iXNjP47JhwCl48uEyQJkVi0miIDZjMBbq8HYokExDM5MFMOsFBWSKYXIbOSL+W2zkJypXCHBZ4UkyxQoTV8anb6gT618EhvNINGo0FVOHJUazmtNwDl8UF4IQO+SBy0ej0EIxGIxueRj6ZL2a1dSK5ufFhPWTOtpnSKUbBr5CWLdgLNSfhoaqADKRRy0KhkoJGJgNLKwWOeAZNSDBZCX61tFJxuF9IZycpCfhsyxR1bHagax/NevA0S0uZHywoOSiu4KC7jooiUC/MyDlpRt8JF2wBccgxDZIwLNqsZArE4mnO4kcVFo8zmHqTXt1V1oHVcYPeIuRAaaystqjofZSd5pbXpLnR6pguKU51oU9sFFxxiyOr6wD7MBVI7AS6PF2lNFLIxSTSfP1MD9tSB86RMQQ1xgRpsBlrMgSjOhVOyVojg3EpA9BYydR9D/uFmlBlvRauqdlSY7ESr2j5kU42U/KkiRHM7n8OXkac98QFAg3tahM8Ot3nJIc67YVX3J7OKkV+G+O1ACk4gj/A4REZbIKPsgNxEB6xP8WCP6EMbswKgQ3EoXrslYp/r+m4jdvuzq/9qX+/fvXtYbzL9Ub1SQBj0FXJCjChxB/KJWlBklIMSOAdtT3eXzlFSCPrpG7UYv3Kw8erlC/uAYsyMOZWCRhPOb1JjWAOhkR3Wz+rkNjs16gon8Dk6ipu0KpwUcnD7YDPOjHDwgpI3mpsVy/xM9BjbGGJhNuW/AQv8O6QPRMaVAAAAAElFTkSuQmCC\",\"aspectRatio\":0.821608040201005,\"src\":\"/static/me-full-4690adb5e52d59c5c7db505c8308872d-7c9e1.png\",\"srcSet\":\"/static/me-full-4690adb5e52d59c5c7db505c8308872d-68f83.png 75w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-24538.png 150w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-7c9e1.png 300w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-fd33d.png 327w\",\"sizes\":\"(max-width: 300px) 100vw, 300px\"}},\"site\":{\"siteMetadata\":{\"url\":\"https://mi3o.com\"}},\"recentPosts\":{\"edges\":[{\"node\":{\"excerpt\":\"As I wrote in my previous post ( How GraphQL beats REST when I am hungry ) GraphQL has only one endpoint and that means our security configuration can…\",\"frontmatter\":{\"title\":\"Secure your GraphQL with Spring AOP\",\"date\":\"November 05, 2018\",\"path\":\"/spring-graphql-security\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"OK, so there we have some Servlet container, some EJB container, Spring container, this container, that container... Cool, everyone uses container…\",\"frontmatter\":{\"title\":\"Throwing a party without a container\",\"date\":\"August 27, 2018\",\"path\":\"/throwing-a-party\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"REST web services proved to be solid standard for communication and became easy way to expose server interfaces to clients. To introduce them into…\",\"frontmatter\":{\"title\":\"How GraphQL beats REST when I am hungry\",\"date\":\"August 16, 2018\",\"path\":\"/how-graphql-beats-rest\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"All courses have either fixed predefined agenda or can have individual scope depending on your specific needs. They can be tailored for beginners…\",\"frontmatter\":{\"title\":\"Courses\",\"date\":\"February 10, 2018\",\"path\":\"/courses\",\"type\":\"page\"}}}]},\"markdownRemark\":{\"html\":\"<p>As I wrote in my previous post (<a href=\\\"https://mi3o.com/how-graphql-beats-rest\\\">How GraphQL beats REST when I am hungry</a>) GraphQL has only one endpoint and that means our security configuration can not be based on requested urls. What could be even worst, there might be some queries or mutations which should be accessible for unauthenticated users, such as login or forgot password... Therefore we lose the possibility to enjoy Spring security filter chain and we must say in general that everyone can try to call our graphQL methods (<code class=\\\"language-text\\\">.antMatchers(&quot;/graphql&quot;).permitAll()</code>):</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityconfig-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-securityconfig-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableWebSecurity</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableGlobalMethodSecurity</span>(<span class=\\\"pl-c1\\\">prePostEnabled</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-c1\\\">true</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityConfig</span> <span class=\\\"pl-k\\\">extends</span> <span class=\\\"pl-e\\\">WebSecurityConfigurerAdapter</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Override</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">protected</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">configure</span>(<span class=\\\"pl-smi\\\">HttpSecurity</span> <span class=\\\"pl-v\\\">http</span>) <span class=\\\"pl-k\\\">throws</span> <span class=\\\"pl-smi\\\">Exception</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        http</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .csrf()<span class=\\\"pl-k\\\">.</span>disable()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .authorizeRequests()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/graphql<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/vendor/**<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/graphiql<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .anyRequest()<span class=\\\"pl-k\\\">.</span>authenticated()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .and()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .formLogin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Override</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">protected</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">configure</span>(<span class=\\\"pl-smi\\\">AuthenticationManagerBuilder</span> <span class=\\\"pl-v\\\">auth</span>) <span class=\\\"pl-k\\\">throws</span> <span class=\\\"pl-smi\\\">Exception</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        auth</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .inMemoryAuthentication()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .passwordEncoder(passwordEncoder())</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .withUser(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>password(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>{noop}nbusr123<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>roles(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>USER<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>and()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .withUser(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>admin<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>password(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>{noop}nbusr123<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>roles(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>USER<span class=\\\"pl-pds\\\">&quot;</span></span>, <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>ADMIN<span class=\\\"pl-pds\\\">&quot;</span></span>);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Bean</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">PasswordEncoder</span> <span class=\\\"pl-en\\\">passwordEncoder</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-smi\\\">PasswordEncoderFactories</span><span class=\\\"pl-k\\\">.</span>createDelegatingPasswordEncoder();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityConfig.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityconfig-java\\\">SecurityConfig.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<p>Technically, we could write our own <code class=\\\"language-text\\\">RequestMatcher</code>, but for that we would need to do the query parsing and resolver mapping and that would mean doing twice the work since the same happens after requests pass the security filter.</p>\\n<br />\\n<p>So what now? Our graphQL endpoint is exposed to everyone but we need to protect our methods which are meant only for authenticated and authorized users. For the case of simplicity I will illustrate the situation with three methods in our meaningless <code class=\\\"language-text\\\">Resolver</code>:</p>\\n<ul>\\n<li><code class=\\\"language-text\\\">unsecuredResource()</code> can be accessed without authentication</li>\\n<li><code class=\\\"language-text\\\">securedResource()</code> can be accessed only by authenticated users</li>\\n<li><code class=\\\"language-text\\\">securedResourceAdmin()</code> can be called only by users with role ADMIN</li>\\n</ul>\\n<br />\\n<h2>Method level security</h2>\\n<p>If you noticed in my SecurityConfig, I used <code class=\\\"language-text\\\">@EnableGlobalMethodSecurity</code> annotation and that opens for us a new world of security restrictions which we can use on methods' level. Demonstrating all features regarding this annotation is out of scope of this post, for us now is sufficient to know that we can name roles that user must have to access the method. Let's have a look at our resolver</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-resourceresolver-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-resourceresolver-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">ResourceResolver</span> <span class=\\\"pl-k\\\">implements</span> <span class=\\\"pl-e\\\">GraphQLQueryResolver</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@PreAuthorize</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>hasRole(&apos;ROLE_ADMIN&apos;)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResourceAdmin</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource Admin<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">unsecuredResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Unsecured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/ResourceResolver.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-resourceresolver-java\\\">ResourceResolver.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<blockquote>\\n<p>Note: For this simple case, where only the user's role is checked, I could use <code class=\\\"language-text\\\">@Secured</code> annotation but in real world application the <code class=\\\"language-text\\\">@Pre*</code> and <code class=\\\"language-text\\\">@Post*</code> are more powerful option, since they allow to use expressions (SpEl) and can access method arguments and returned values (<a href=\\\"https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#el-pre-post-annotations\\\">Spring docs</a>).</p>\\n</blockquote>\\n<br />\\n<p>We could secure every method which requires authentication or authorization just using this annotation, but best would be to have a defensive fallback scenario. We don't want to write annotations everywhere and we don't want to have sleepless nights thinking that we might have forgotten to annotate some method - we need a reasonable default that would say: every method without specified security annotation should require by default at least authentication.</p>\\n<br />\\n<h2>Spring AOP</h2>\\n<p>If we want to play with Aspect Oriented Programming in Spring, first, we need to enable AOP somewhere in our configuration with <code class=\\\"language-text\\\">@EnableAspectJAutoProxy</code> annotation</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-springgraphqlsecurityapplication-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@SpringBootApplication</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableAspectJAutoProxy</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SpringGraphqlSecurityApplication</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t<span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">static</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">main</span>(<span class=\\\"pl-k\\\">String</span>[] <span class=\\\"pl-v\\\">args</span>) {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t\\t<span class=\\\"pl-smi\\\">SpringApplication</span><span class=\\\"pl-k\\\">.</span>run(<span class=\\\"pl-smi\\\">SpringGraphqlSecurityApplication</span><span class=\\\"pl-k\\\">.</span>class, args);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t}</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SpringGraphqlSecurityApplication.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-springgraphqlsecurityapplication-java\\\">SpringGraphqlSecurityApplication.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<p>The magic behind security done by AOP is following:</p>\\n<ol>\\n<li>We need to say that every method, which is inside class that implements (any type of) <code class=\\\"language-text\\\">Resolver</code> interface, should throw an Exception in case there is no authentication in security context.</li>\\n<li>Note that only resolvers defined in our application should be taken into consideration, otherwise GraphQL framework's classes will be intercepted during application start up.</li>\\n<li>Additionally, we can name exact methods which will be excluded from this check, in our case <code class=\\\"language-text\\\">unsecuredResource()</code>.</li>\\n</ol>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityqraphqlaspect-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Aspect</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Order</span>(<span class=\\\"pl-c1\\\">1</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityQraphQLAspect</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * All graphQLResolver methods can be called only by authenticated user.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Exclusions are named in Pointcut expression.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Before</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>allGraphQLResolverMethods() &amp;&amp; isDefinedInApplication() &amp;&amp; !isUnsecuredResourceMethod()<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">doSecurityCheck</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">if</span> (<span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext() <span class=\\\"pl-k\\\">==</span> <span class=\\\"pl-c1\\\">null</span> <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication() <span class=\\\"pl-k\\\">==</span> <span class=\\\"pl-c1\\\">null</span> <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-k\\\">!</span><span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication()<span class=\\\"pl-k\\\">.</span>isAuthenticated() <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-smi\\\">AnonymousAuthenticationToken</span><span class=\\\"pl-k\\\">.</span>class<span class=\\\"pl-k\\\">.</span>isAssignableFrom(<span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication()<span class=\\\"pl-k\\\">.</span>getClass())) {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            <span class=\\\"pl-k\\\">throw</span> <span class=\\\"pl-k\\\">new</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>User not authenticated<span class=\\\"pl-pds\\\">&quot;</span></span>);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Matches all beans that implement {<span class=\\\"pl-k\\\">@link</span> com.coxautodev.graphql.tools.GraphQLResolver}</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * note: {<span class=\\\"pl-k\\\">@code</span><span class=\\\"pl-c1\\\"> GraphQLMutationResolver</span>}, {<span class=\\\"pl-k\\\">@code</span><span class=\\\"pl-c1\\\"> GraphQLQueryResolver</span>} etc</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * extend base GraphQLResolver interface</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>target(com.coxautodev.graphql.tools.GraphQLResolver)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">allGraphQLResolverMethods</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Matches all beans in com.mi3o.springgraphqlsecurity package</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L31\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"31\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC31\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * resolvers must be in this package (subpackages)</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L32\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"32\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC32\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L33\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"33\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC33\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>within(com.mi3o.springgraphqlsecurity..*)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L34\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"34\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC34\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isDefinedInApplication</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L35\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"35\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC35\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L36\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"36\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC36\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L37\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"37\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC37\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L38\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"38\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC38\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Exact method signature which will be excluded from security check</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L39\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"39\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC39\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L40\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"40\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC40\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>execution(public java.lang.String com.mi3o.springgraphqlsecurity.resolver.ResourceResolver.unsecuredResource())<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L41\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"41\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC41\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isUnsecuredResourceMethod</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L42\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"42\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC42\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L43\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"43\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC43\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityQraphQLAspect.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityqraphqlaspect-java\\\">SecurityQraphQLAspect.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<blockquote>\\n<p>Important: Did you notice the <code class=\\\"language-text\\\">@Order(1)</code> annotation in my aspect? We must ensure that our security aspect is triggered the very first prior any other interceptor if we want to have consistent API (our Exception needs to be the first one to be thrown in case user is not authenticated).</p>\\n</blockquote>\\n<br />\\n<h2>Custom annotation</h2>\\n<p>The above explanation should give you the overview of the AOP security idea but we can go one step further and simplify it a bit. In current solution the unsecured method specification is wired and hard-coded in aspect class and is based on exact method signature. Let's create our own annotation that can be reused on any method without further fiddling with pointcut expressions</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-unsecured-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> * Marking annotation that will switch off security check for given method.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> * Works only for methods defined in GraphQL Resolvers</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Retention</span>(<span class=\\\"pl-smi\\\">RetentionPolicy</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>RUNTIME</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Target</span>(<span class=\\\"pl-smi\\\">ElementType</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>METHOD</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">@interface</span> <span class=\\\"pl-en\\\">Unsecured</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/Unsecured.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-unsecured-java\\\">Unsecured.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>Now we need to update our aspect class a bit and exclude methods which are annotated with <code class=\\\"language-text\\\">@Unsecured</code></p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityqraphqlaspectwithannotation-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Aspect</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Order</span>(<span class=\\\"pl-c1\\\">1</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityQraphQLAspect</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * All graphQLResolver methods can be called only by authenticated user.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * <span class=\\\"pl-k\\\">@Unsecured</span> annotated methods are excluded</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Before</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>allGraphQLResolverMethods() &amp;&amp; isDefinedInApplication() &amp;&amp; !isMethodAnnotatedAsUnsecured()<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">doSecurityCheck</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> same as shown previously</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Any method annotated with <span class=\\\"pl-k\\\">@Unsecured</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>@annotation(com.mi3o.springgraphqlsecurity.config.Unsecured)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isMethodAnnotatedAsUnsecured</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityQraphQLAspectWithAnnotation.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityqraphqlaspectwithannotation-java\\\">SecurityQraphQLAspectWithAnnotation.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>Having our own annotation on method is cleaner solution, since everyone can see directly in the code that given method is not protected, instead of having it buried somewhere in the configuration. As a result, our resolvers will look similarly to the following one</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-resourceresolverwithunsecured-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">ResourceResolver</span> <span class=\\\"pl-k\\\">implements</span> <span class=\\\"pl-e\\\">GraphQLQueryResolver</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method requires authenticated user by default</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method requires user with role ADMIN</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@PreAuthorize</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>hasRole(&#39;ROLE_ADMIN&#39;)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResourceAdmin</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource Admin<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method can be called by unauthenticated user</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Unsecured</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">unsecuredResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Unsecured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/ResourceResolverWithUnsecured.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-resourceresolverwithunsecured-java\\\">ResourceResolverWithUnsecured.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>That's it. Every method in our resolvers (except explicitly annotated ones) is now secured and requires authentication. Additional rules can be implemented using @Pre @Post annotations or programmatically e.g. using <code class=\\\"language-text\\\">hasPermission</code> SpEl method.</p>\\n<br />\\n<p>And finally, working with AOP and interceptors is safest when covered by integration tests :-)</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-springgraphqlsecurityapplicationtests-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@RunWith</span>(<span class=\\\"pl-smi\\\">SpringRunner</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@SpringBootTest</span>(<span class=\\\"pl-c1\\\">webEnvironment</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">SpringBootTest</span><span class=\\\"pl-k\\\">.</span><span class=\\\"pl-smi\\\">WebEnvironment</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>RANDOM_PORT</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SpringGraphqlSecurityApplicationTests</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Autowired</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-smi\\\">ResourceResolver</span> resourceResolver;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">unsecured_resource_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>unsecuredResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">secured_unauthorized_access_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">secured_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">admin_unauthorized_access_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L31\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"31\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC31\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">without_admin_role_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L32\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"32\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC32\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L33\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"33\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC33\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L34\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"34\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC34\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L35\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"35\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC35\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>admin<span class=\\\"pl-pds\\\">&quot;</span></span>, <span class=\\\"pl-c1\\\">roles</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>ADMIN<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L36\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"36\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC36\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L37\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"37\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC37\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">admin_role_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L38\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"38\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC38\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L39\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"39\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC39\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L40\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"40\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC40\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SpringGraphqlSecurityApplicationTests.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-springgraphqlsecurityapplicationtests-java\\\">SpringGraphqlSecurityApplicationTests.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>You can find full working example in my github repository:\\n<a href=\\\"https://github.com/michalgebauer/spring-graphql-security\\\">spring-graphql-security</a>.</p>\\n<p>Thank you for reading.</p>\",\"excerpt\":\"As I wrote in my previous post ( How GraphQL beats REST when I am hungry ) GraphQL has only one…\",\"frontmatter\":{\"date\":\"November 05, 2018\",\"path\":\"/spring-graphql-security\",\"title\":\"Secure your GraphQL with Spring AOP\",\"label\":[\"Spring\",\"java\",\"Spring boot\",\"Spring Security\",\"AOP\",\"GraphQL\",\"graphql-spring-boot-starter\",\"graphql-java-tools\",\"com.graphql-java\"],\"author\":\"Michal Gebauer\",\"type\":\"blog\",\"image\":{\"publicURL\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3.png\",\"childImageSharp\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVQI1z3MuQqFMBQEUD9QLMRO00pqsbAKBgI2LmjhgiCJG4ji0ihByLd5i8drppk5ox3Hcd+3Uup9X85527bTND3PI6W8rmtd177v67qO45gQ4nme67q2bVuWZRiGtizLvu8wAlYURZZlURSN47ht23me0AohAKdpGoah7/sYY4TQDw/DUFVVnueMMUppEASQ8NU0DVzM89x1XVmWSZL8seM4pmnquv4Bj2ljZKU0Xj8AAAAASUVORK5CYII=\",\"aspectRatio\":5.91156462585034,\"src\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3-b739c.png\",\"srcSet\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3-81691.png 310w,\\n/static/security-8dd7ec3473cc559da9e1a96665adfed3-4d50e.png 620w,\\n/static/security-8dd7ec3473cc559da9e1a96665adfed3-b739c.png 869w\",\"sizes\":\"(max-width: 869px) 100vw, 869px\"}}}}}},\"pathContext\":{}}\n\n/***/ })\n\n});\n\n\n// WEBPACK FOOTER //\n// path---spring-graphql-security-5eecaf9e07bbb1ddcb13.js","module.exports = {\"data\":{\"meImage\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAC4jAAAuIwF4pT92AAAFC0lEQVQ4y2WUa0yTVxjHT4WMeAsOvABWLdCWtvYt9PLSFkovFCj0Qul6oUVHL/RCoWC5RlBaLkFAlCEoqCzsln1xyzKzLG6JHxaXLRnZB5eYLdtMFnQf9mH7sOgHtfQ8430VCdlJ3jwnJ///L8953uc5CL1aCkE+HS1qHmPr7HzMxLTp+KrWRlI9O+xhbp13+uoztvary0n0+NHvaMfq8Fnp6KiT7qLiOxPhvTYtf6GKKHgiPJELJcdyQFTC/NtYLRm89/nEPkpDFmfv2vJ/duvmNmwmEaSjz6mlMwMAhpo4+n0pKweYB/fD0dx9ac6R7DQ/PxuK8t+EclHhg+uzXSpKuxshxqYeWeSHt4GCAoQujceoLQ3USgo/OnnsAOQd2PO86ND+tFlYgLu1XDxUJ0i/TRa+OJ6zF/TykudLk2EhfbtTOobX7ULrf/y2DdUreHT6BjWhIrl5QBRkpw28fNyr48GcXYoXnCS+YpfhKw4SoiruM/aR/VCr4M5RHoKVm7Gjfv3tjagwN4s+JAXMcaeKC0Mm0YvZJglcc8nxvF0GSy453PBU4AUHiRc8yrSOlwd81uFf/1m7uYfytVqV2xkORJtQ0YFMGqiWFM51N0rg/FvSVLyahxfcClhtrYKrngoYtYhhtlmOl/0afKqCDULWwSe9p7V0a9Qr2IzXwPnpGFIRTBqokbFjXU1S8KtLUnpeAY5UsmHFVwEJsxjspcchqjsJS0Ed9mtLgOTlp4fabSWU75SlgrHj2k0KDg2sFh6zd1ul0GeWbNilHBwkC2HRJoOROgJCagIGLXJ8I1KTDukFYCxj/fXhxRj9eztdWsaj9Ve9+MWdD9AZ5Utgh6zo9KhDAZNOMpVsIPAFcxm+blfAsqdy81PilYAOViK1G2P2ckhoBT//6KrLonyX9KWbzf3wJfD+wzU0qBfSwD41rynpkMN0c/nGtJnAwzUn8aRFCvONJLzvrcKrbRq8HNJvXHAqYEwr+JbyhDQ5aLJavA2k1phDSbfNlKOSjDeI0mNOKQwbBDiu4eHhWiFMmsSw6FHCexEdzLSqXkw7lHDZVjlBe4yyzB31e/DoPjpXL0OmejZd2IBBlEw4JNCjK0lFyophQMyBoUoCksZSvNymSg87SRiwKFe/6fXlUvprrUZGT14Werz+cOc8+w1ldJYuM1kcqBU866nlQaJOiMdqCFh2q2DOrcBzPhVETeKn7jbPEUp7zqmjPT+t3dsJG7Eq6Gguzadr2VjBXW0kT0BYxU4lGkSQtEogbhKlovUiCFQTX1Oa8myUQc2x79BOFlqcT6DxsX56HzKX0/XoNAhjNnkxaARHU2YxC0wSFhjFLNxWxYUuveipN+D1U7oabQWdQCAcQhcvzaC7d+8glEz2ou7uICMcac3kIEQLepyalWg1H1qU7JRHUUxFuqmnjETaq5HA2UQS1n747gQ9uoMDb1yYGn/50AiE6H8r2hU8a1aJoVvH24gbCJzcnOlRqwxGDULsVQogFo+nklMzcKav75Ovvvx03+tHt7sz4+a716n379/M8yNxjs/vbuno8H/sbmnGfOZh6K/hYwp0sVkByQbhZu1k0BZux+cmJiHW278RiLSDLxj8s3+wL3b79q3drzPy+lp+cbpsaU+LC0KRIFhsTlzKKcZhJWtzhstw/+bYNVXJoNZogeiZHjw4ksRt0RhYbbZUs8cNXr8XItHw+uDZgb6rS4tZ/wHWLgJEUscfmAAAAABJRU5ErkJggg==\",\"aspectRatio\":1.0256410256410255,\"src\":\"/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-20c2d.png\",\"srcSet\":\"/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-4e92c.png 75w,\\n/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-93059.png 150w,\\n/static/me-cut-small-734f68ab3adb6455e4aeeb3ba3189708-20c2d.png 200w\",\"sizes\":\"(max-width: 200px) 100vw, 200px\"}},\"meImageFull\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAYCAYAAAD6S912AAAACXBIWXMAAC4jAAAuIwF4pT92AAAFYUlEQVQ4y42UfWxaVRTAX5sav7LFj21u1kK/WOkHbWkp9FEoUFpKofDgUR7fH4/H5ygUSgstLfRj3dplm5tzc1GjWcwy/zf70yzqX5q4ZCZGs/iHxmjin0v8xw24R3jdWIzR7iYv59x7zvnde86792DYf4xZRS8rp0baGmoSADDjOB9XSHv6n/hoVELWRigF2DMN+SCHDbCoe14VtB+9w3vzFejnHikJ+S039rZCr7OwaVHDM8FMEwKM82JDY00X80/cGue9AeGxztI542CFxjtB3Ntys2ZrPdTUmGZmDwZOSnjszpzu1sN2Bf/ngr4fPnBJy1coSfltmwQUvc2/8QTtr9V8lKKOg09pkvIfay83RXWD3/plXbCjHyin1YLKNoWDU971u6Sv7XjNwyrvORiYV/U+1Ynhu2dMQ3BWJyxfd4yVP4pMwoZeeP/ykSPP1+x76v6DU972qrElHZ+tYZYYur5tHIBlKb/0jkVSvhIYh4JRcrFmyxhFjZco5f/DUukwK8OEhAXatQM8r7zzz/xEL+yQI5AyDv1YXWZtSw41m+5iJoXdu/fNP0GJZLSuh8J0o0QgaHwyp8ZO/mCRdIBX2oFik8K/cmtrU2z9rHNNubVVFnpqYeEpbHd3pa77Ar466Np7u0fnrKZzAUUvbBHCSlYjKC/FQpBayf8aDDFjT/zS2Ww9BhsexjAmxDyG+VlDMhVTOF3UF5SNfDA1owPrCA+WZoaQZkIFwUS67Pb5weV2Qiweu71aLLzFQpeX9qHbp/OsDEaC7EI8EZM7PS7weF1AkiYwkeby5LgMkQQBxByFSAtZg1U8fl85nkpDOpv7/sz584f27xtpwCRjKmxzc5mdf/3VzRc8fs99yumqBjke+mkPCoSCYK6CAkEGMcEACjB+5PR4wOnzo0R68WGusAErhYKdBcwQFlY63K7nanI+GfUGo1GwOpwlr88N4WgI+YLVjwmA1+8FX3WNCYWAcrmrG4XRqWSqnC1uwfJ6MV+vocFkYlM1EMZjbq/7JzocAavNVqEZGoWjEWRz2KG6IXjoAPgCDLiDUTBarFU9gJJL2dLa6V1IrRY/3j+hwcD+cpdl+iXNjP47JhwCl48uEyQJkVi0miIDZjMBbq8HYokExDM5MFMOsFBWSKYXIbOSL+W2zkJypXCHBZ4UkyxQoTV8anb6gT618EhvNINGo0FVOHJUazmtNwDl8UF4IQO+SBy0ej0EIxGIxueRj6ZL2a1dSK5ufFhPWTOtpnSKUbBr5CWLdgLNSfhoaqADKRRy0KhkoJGJgNLKwWOeAZNSDBZCX61tFJxuF9IZycpCfhsyxR1bHagax/NevA0S0uZHywoOSiu4KC7jooiUC/MyDlpRt8JF2wBccgxDZIwLNqsZArE4mnO4kcVFo8zmHqTXt1V1oHVcYPeIuRAaaystqjofZSd5pbXpLnR6pguKU51oU9sFFxxiyOr6wD7MBVI7AS6PF2lNFLIxSTSfP1MD9tSB86RMQQ1xgRpsBlrMgSjOhVOyVojg3EpA9BYydR9D/uFmlBlvRauqdlSY7ESr2j5kU42U/KkiRHM7n8OXkac98QFAg3tahM8Ot3nJIc67YVX3J7OKkV+G+O1ACk4gj/A4REZbIKPsgNxEB6xP8WCP6EMbswKgQ3EoXrslYp/r+m4jdvuzq/9qX+/fvXtYbzL9Ub1SQBj0FXJCjChxB/KJWlBklIMSOAdtT3eXzlFSCPrpG7UYv3Kw8erlC/uAYsyMOZWCRhPOb1JjWAOhkR3Wz+rkNjs16gon8Dk6ipu0KpwUcnD7YDPOjHDwgpI3mpsVy/xM9BjbGGJhNuW/AQv8O6QPRMaVAAAAAElFTkSuQmCC\",\"aspectRatio\":0.821608040201005,\"src\":\"/static/me-full-4690adb5e52d59c5c7db505c8308872d-7c9e1.png\",\"srcSet\":\"/static/me-full-4690adb5e52d59c5c7db505c8308872d-68f83.png 75w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-24538.png 150w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-7c9e1.png 300w,\\n/static/me-full-4690adb5e52d59c5c7db505c8308872d-fd33d.png 327w\",\"sizes\":\"(max-width: 300px) 100vw, 300px\"}},\"site\":{\"siteMetadata\":{\"url\":\"https://mi3o.com\"}},\"recentPosts\":{\"edges\":[{\"node\":{\"excerpt\":\"As I wrote in my previous post ( How GraphQL beats REST when I am hungry ) GraphQL has only one endpoint and that means our security configuration can…\",\"frontmatter\":{\"title\":\"Secure your GraphQL with Spring AOP\",\"date\":\"November 05, 2018\",\"path\":\"/spring-graphql-security\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"OK, so there we have some Servlet container, some EJB container, Spring container, this container, that container... Cool, everyone uses container…\",\"frontmatter\":{\"title\":\"Throwing a party without a container\",\"date\":\"August 27, 2018\",\"path\":\"/throwing-a-party\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"REST web services proved to be solid standard for communication and became easy way to expose server interfaces to clients. To introduce them into…\",\"frontmatter\":{\"title\":\"How GraphQL beats REST when I am hungry\",\"date\":\"August 16, 2018\",\"path\":\"/how-graphql-beats-rest\",\"type\":\"blog\"}}},{\"node\":{\"excerpt\":\"All courses have either fixed predefined agenda or can have individual scope depending on your specific needs. They can be tailored for beginners…\",\"frontmatter\":{\"title\":\"Courses\",\"date\":\"February 10, 2018\",\"path\":\"/courses\",\"type\":\"page\"}}}]},\"markdownRemark\":{\"html\":\"<p>As I wrote in my previous post (<a href=\\\"https://mi3o.com/how-graphql-beats-rest\\\">How GraphQL beats REST when I am hungry</a>) GraphQL has only one endpoint and that means our security configuration can not be based on requested urls. What could be even worst, there might be some queries or mutations which should be accessible for unauthenticated users, such as login or forgot password... Therefore we lose the possibility to enjoy Spring security filter chain and we must say in general that everyone can try to call our graphQL methods (<code class=\\\"language-text\\\">.antMatchers(&quot;/graphql&quot;).permitAll()</code>):</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityconfig-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-securityconfig-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableWebSecurity</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableGlobalMethodSecurity</span>(<span class=\\\"pl-c1\\\">prePostEnabled</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-c1\\\">true</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityConfig</span> <span class=\\\"pl-k\\\">extends</span> <span class=\\\"pl-e\\\">WebSecurityConfigurerAdapter</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Override</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">protected</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">configure</span>(<span class=\\\"pl-smi\\\">HttpSecurity</span> <span class=\\\"pl-v\\\">http</span>) <span class=\\\"pl-k\\\">throws</span> <span class=\\\"pl-smi\\\">Exception</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        http</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .csrf()<span class=\\\"pl-k\\\">.</span>disable()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .authorizeRequests()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/graphql<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/vendor/**<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .antMatchers(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>/graphiql<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>permitAll()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .anyRequest()<span class=\\\"pl-k\\\">.</span>authenticated()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .and()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .formLogin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Override</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">protected</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">configure</span>(<span class=\\\"pl-smi\\\">AuthenticationManagerBuilder</span> <span class=\\\"pl-v\\\">auth</span>) <span class=\\\"pl-k\\\">throws</span> <span class=\\\"pl-smi\\\">Exception</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        auth</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            .inMemoryAuthentication()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .passwordEncoder(passwordEncoder())</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .withUser(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>password(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>{noop}nbusr123<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>roles(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>USER<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>and()</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                .withUser(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>admin<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>password(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>{noop}nbusr123<span class=\\\"pl-pds\\\">&quot;</span></span>)<span class=\\\"pl-k\\\">.</span>roles(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>USER<span class=\\\"pl-pds\\\">&quot;</span></span>, <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>ADMIN<span class=\\\"pl-pds\\\">&quot;</span></span>);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Bean</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">PasswordEncoder</span> <span class=\\\"pl-en\\\">passwordEncoder</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-smi\\\">PasswordEncoderFactories</span><span class=\\\"pl-k\\\">.</span>createDelegatingPasswordEncoder();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityconfig-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-securityconfig-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityConfig.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityconfig-java\\\">SecurityConfig.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<p>Technically, we could write our own <code class=\\\"language-text\\\">RequestMatcher</code>, but for that we would need to do the query parsing and resolver mapping and that would mean doing twice the work since the same happens after requests pass the security filter.</p>\\n<br />\\n<p>So what now? Our graphQL endpoint is exposed to everyone but we need to protect our methods which are meant only for authenticated and authorized users. For the case of simplicity I will illustrate the situation with three methods in our meaningless <code class=\\\"language-text\\\">Resolver</code>:</p>\\n<ul>\\n<li><code class=\\\"language-text\\\">unsecuredResource()</code> can be accessed without authentication</li>\\n<li><code class=\\\"language-text\\\">securedResource()</code> can be accessed only by authenticated users</li>\\n<li><code class=\\\"language-text\\\">securedResourceAdmin()</code> can be called only by users with role ADMIN</li>\\n</ul>\\n<br />\\n<h2>Method level security</h2>\\n<p>If you noticed in my SecurityConfig, I used <code class=\\\"language-text\\\">@EnableGlobalMethodSecurity</code> annotation and that opens for us a new world of security restrictions which we can use on methods' level. Demonstrating all features regarding this annotation is out of scope of this post, for us now is sufficient to know that we can name roles that user must have to access the method. Let's have a look at our resolver</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-resourceresolver-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-resourceresolver-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">ResourceResolver</span> <span class=\\\"pl-k\\\">implements</span> <span class=\\\"pl-e\\\">GraphQLQueryResolver</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@PreAuthorize</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>hasRole(&apos;ROLE_ADMIN&apos;)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResourceAdmin</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource Admin<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">unsecuredResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Unsecured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolver-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-resourceresolver-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/ResourceResolver.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-resourceresolver-java\\\">ResourceResolver.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<blockquote>\\n<p>Note: For this simple case, where only the user's role is checked, I could use <code class=\\\"language-text\\\">@Secured</code> annotation but in real world application the <code class=\\\"language-text\\\">@Pre*</code> and <code class=\\\"language-text\\\">@Post*</code> are more powerful option, since they allow to use expressions (SpEl) and can access method arguments and returned values (<a href=\\\"https://docs.spring.io/spring-security/site/docs/current/reference/htmlsingle/#el-pre-post-annotations\\\">Spring docs</a>).</p>\\n</blockquote>\\n<br />\\n<p>We could secure every method which requires authentication or authorization just using this annotation, but best would be to have a defensive fallback scenario. We don't want to write annotations everywhere and we don't want to have sleepless nights thinking that we might have forgotten to annotate some method - we need a reasonable default that would say: every method without specified security annotation should require by default at least authentication.</p>\\n<br />\\n<h2>Spring AOP</h2>\\n<p>If we want to play with Aspect Oriented Programming in Spring, first, we need to enable AOP somewhere in our configuration with <code class=\\\"language-text\\\">@EnableAspectJAutoProxy</code> annotation</p>\\n<br />\\n<p><html><head></head><body><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-springgraphqlsecurityapplication-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tbody><tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@SpringBootApplication</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@EnableAspectJAutoProxy</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SpringGraphqlSecurityApplication</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t<span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">static</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">main</span>(<span class=\\\"pl-k\\\">String</span>[] <span class=\\\"pl-v\\\">args</span>) {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t\\t<span class=\\\"pl-smi\\\">SpringApplication</span><span class=\\\"pl-k\\\">.</span>run(<span class=\\\"pl-smi\\\">SpringGraphqlSecurityApplication</span><span class=\\\"pl-k\\\">.</span>class, args);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\t}</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplication-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</tbody></table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SpringGraphqlSecurityApplication.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-springgraphqlsecurityapplication-java\\\">SpringGraphqlSecurityApplication.java</a>\\n        hosted with &#x2764; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</body></html></p>\\n<br />\\n<p>The magic behind security done by AOP is following:</p>\\n<ol>\\n<li>We need to say that every method, which is inside class that implements (any type of) <code class=\\\"language-text\\\">Resolver</code> interface, should throw an Exception in case there is no authentication in security context.</li>\\n<li>Note that only resolvers defined in our application should be taken into consideration, otherwise GraphQL framework's classes will be intercepted during application start up.</li>\\n<li>Additionally, we can name exact methods which will be excluded from this check, in our case <code class=\\\"language-text\\\">unsecuredResource()</code>.</li>\\n</ol>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityqraphqlaspect-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Aspect</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Order</span>(<span class=\\\"pl-c1\\\">1</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityQraphQLAspect</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * All graphQLResolver methods can be called only by authenticated user.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Exclusions are named in Pointcut expression.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Before</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>allGraphQLResolverMethods() &amp;&amp; isDefinedInApplication() &amp;&amp; !isUnsecuredResourceMethod()<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">doSecurityCheck</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">if</span> (<span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext() <span class=\\\"pl-k\\\">==</span> <span class=\\\"pl-c1\\\">null</span> <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication() <span class=\\\"pl-k\\\">==</span> <span class=\\\"pl-c1\\\">null</span> <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-k\\\">!</span><span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication()<span class=\\\"pl-k\\\">.</span>isAuthenticated() <span class=\\\"pl-k\\\">||</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">                <span class=\\\"pl-smi\\\">AnonymousAuthenticationToken</span><span class=\\\"pl-k\\\">.</span>class<span class=\\\"pl-k\\\">.</span>isAssignableFrom(<span class=\\\"pl-smi\\\">SecurityContextHolder</span><span class=\\\"pl-k\\\">.</span>getContext()<span class=\\\"pl-k\\\">.</span>getAuthentication()<span class=\\\"pl-k\\\">.</span>getClass())) {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">            <span class=\\\"pl-k\\\">throw</span> <span class=\\\"pl-k\\\">new</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>User not authenticated<span class=\\\"pl-pds\\\">&quot;</span></span>);</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Matches all beans that implement {<span class=\\\"pl-k\\\">@link</span> com.coxautodev.graphql.tools.GraphQLResolver}</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * note: {<span class=\\\"pl-k\\\">@code</span><span class=\\\"pl-c1\\\"> GraphQLMutationResolver</span>}, {<span class=\\\"pl-k\\\">@code</span><span class=\\\"pl-c1\\\"> GraphQLQueryResolver</span>} etc</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * extend base GraphQLResolver interface</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>target(com.coxautodev.graphql.tools.GraphQLResolver)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">allGraphQLResolverMethods</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Matches all beans in com.mi3o.springgraphqlsecurity package</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L31\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"31\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC31\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * resolvers must be in this package (subpackages)</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L32\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"32\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC32\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L33\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"33\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC33\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>within(com.mi3o.springgraphqlsecurity..*)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L34\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"34\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC34\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isDefinedInApplication</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L35\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"35\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC35\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L36\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"36\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC36\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L37\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"37\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC37\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L38\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"38\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC38\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Exact method signature which will be excluded from security check</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L39\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"39\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC39\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L40\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"40\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC40\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>execution(public java.lang.String com.mi3o.springgraphqlsecurity.resolver.ResourceResolver.unsecuredResource())<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L41\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"41\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC41\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isUnsecuredResourceMethod</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L42\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"42\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC42\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspect-java-L43\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"43\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspect-java-LC43\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityQraphQLAspect.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityqraphqlaspect-java\\\">SecurityQraphQLAspect.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<blockquote>\\n<p>Important: Did you notice the <code class=\\\"language-text\\\">@Order(1)</code> annotation in my aspect? We must ensure that our security aspect is triggered the very first prior any other interceptor if we want to have consistent API (our Exception needs to be the first one to be thrown in case user is not authenticated).</p>\\n</blockquote>\\n<br />\\n<h2>Custom annotation</h2>\\n<p>The above explanation should give you the overview of the AOP security idea but we can go one step further and simplify it a bit. In current solution the unsecured method specification is wired and hard-coded in aspect class and is based on exact method signature. Let's create our own annotation that can be reused on any method without further fiddling with pointcut expressions</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-unsecured-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> * Marking annotation that will switch off security check for given method.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> * Works only for methods defined in GraphQL Resolvers</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\"> <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Retention</span>(<span class=\\\"pl-smi\\\">RetentionPolicy</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>RUNTIME</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Target</span>(<span class=\\\"pl-smi\\\">ElementType</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>METHOD</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">@interface</span> <span class=\\\"pl-en\\\">Unsecured</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-unsecured-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-unsecured-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/Unsecured.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-unsecured-java\\\">Unsecured.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>Now we need to update our aspect class a bit and exclude methods which are annotated with <code class=\\\"language-text\\\">@Unsecured</code></p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-securityqraphqlaspectwithannotation-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Aspect</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Order</span>(<span class=\\\"pl-c1\\\">1</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SecurityQraphQLAspect</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * All graphQLResolver methods can be called only by authenticated user.</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * <span class=\\\"pl-k\\\">@Unsecured</span> annotated methods are excluded</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Before</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>allGraphQLResolverMethods() &amp;&amp; isDefinedInApplication() &amp;&amp; !isMethodAnnotatedAsUnsecured()<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">doSecurityCheck</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> same as shown previously</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">/**</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     * Any method annotated with <span class=\\\"pl-k\\\">@Unsecured</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-c\\\">     <span class=\\\"pl-c\\\">*/</span></span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Pointcut</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>@annotation(com.mi3o.springgraphqlsecurity.config.Unsecured)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">isMethodAnnotatedAsUnsecured</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-securityqraphqlaspectwithannotation-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SecurityQraphQLAspectWithAnnotation.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-securityqraphqlaspectwithannotation-java\\\">SecurityQraphQLAspectWithAnnotation.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>Having our own annotation on method is cleaner solution, since everyone can see directly in the code that given method is not protected, instead of having it buried somewhere in the configuration. As a result, our resolvers will look similarly to the following one</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-resourceresolverwithunsecured-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@Component</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">ResourceResolver</span> <span class=\\\"pl-k\\\">implements</span> <span class=\\\"pl-e\\\">GraphQLQueryResolver</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method requires authenticated user by default</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method requires user with role ADMIN</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@PreAuthorize</span>(<span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>hasRole(&#39;ROLE_ADMIN&#39;)<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">securedResourceAdmin</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Secured resource Admin<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-c\\\"><span class=\\\"pl-c\\\">//</span> This method can be called by unauthenticated user</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Unsecured</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-smi\\\">String</span> <span class=\\\"pl-en\\\">unsecuredResource</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        <span class=\\\"pl-k\\\">return</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>Unsecured resource<span class=\\\"pl-pds\\\">&quot;</span></span>;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-resourceresolverwithunsecured-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/ResourceResolverWithUnsecured.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-resourceresolverwithunsecured-java\\\">ResourceResolverWithUnsecured.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>That's it. Every method in our resolvers (except explicitly annotated ones) is now secured and requires authentication. Additional rules can be implemented using @Pre @Post annotations or programmatically e.g. using <code class=\\\"language-text\\\">hasPermission</code> SpEl method.</p>\\n<br />\\n<p>And finally, working with AOP and interceptors is safest when covered by integration tests :-)</p>\\n<br />\\n<p><div id=\\\"gist92865801\\\" class=\\\"gist\\\">\\n    <div class=\\\"gist-file\\\">\\n      <div class=\\\"gist-data\\\">\\n        <div class=\\\"js-gist-file-update-container js-task-list-container file-box\\\">\\n  <div id=\\\"file-springgraphqlsecurityapplicationtests-java\\\" class=\\\"file\\\">\\n    \\n\\n  <div itemprop=\\\"text\\\" class=\\\"blob-wrapper data type-java \\\">\\n      <table class=\\\"highlight tab-size js-file-line-container\\\" data-tab-size=\\\"8\\\">\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L1\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"1\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC1\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@RunWith</span>(<span class=\\\"pl-smi\\\">SpringRunner</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L2\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"2\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC2\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">@SpringBootTest</span>(<span class=\\\"pl-c1\\\">webEnvironment</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">SpringBootTest</span><span class=\\\"pl-k\\\">.</span><span class=\\\"pl-smi\\\">WebEnvironment</span><span class=\\\"pl-c1\\\"><span class=\\\"pl-k\\\">.</span>RANDOM_PORT</span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L3\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"3\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC3\\\" class=\\\"blob-code blob-code-inner js-file-line\\\"><span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">class</span> <span class=\\\"pl-en\\\">SpringGraphqlSecurityApplicationTests</span> {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L4\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"4\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC4\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L5\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"5\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC5\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Autowired</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L6\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"6\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC6\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">private</span> <span class=\\\"pl-smi\\\">ResourceResolver</span> resourceResolver;</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L7\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"7\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC7\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L8\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"8\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC8\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L9\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"9\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC9\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">unsecured_resource_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L10\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"10\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC10\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>unsecuredResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L11\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"11\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC11\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L12\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"12\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC12\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L13\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"13\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC13\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L14\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"14\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC14\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">secured_unauthorized_access_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L15\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"15\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC15\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L16\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"16\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC16\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L17\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"17\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC17\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L18\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"18\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC18\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L19\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"19\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC19\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L20\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"20\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC20\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">secured_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L21\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"21\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC21\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResource();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L22\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"22\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC22\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L23\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"23\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC23\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L24\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"24\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC24\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L25\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"25\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC25\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">admin_unauthorized_access_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L26\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"26\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC26\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L27\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"27\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC27\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L28\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"28\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC28\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L29\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"29\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC29\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>mi3o<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L30\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"30\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC30\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span>(<span class=\\\"pl-c1\\\">expected</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-smi\\\">AccessDeniedException</span><span class=\\\"pl-k\\\">.</span>class)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L31\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"31\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC31\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">without_admin_role_throws_exception</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L32\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"32\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC32\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L33\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"33\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC33\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L34\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"34\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC34\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">\\n</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L35\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"35\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC35\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@WithMockUser</span>(<span class=\\\"pl-c1\\\">username</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>admin<span class=\\\"pl-pds\\\">&quot;</span></span>, <span class=\\\"pl-c1\\\">roles</span> <span class=\\\"pl-k\\\">=</span> <span class=\\\"pl-s\\\"><span class=\\\"pl-pds\\\">&quot;</span>ADMIN<span class=\\\"pl-pds\\\">&quot;</span></span>)</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L36\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"36\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC36\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">@Test</span></td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L37\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"37\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC37\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    <span class=\\\"pl-k\\\">public</span> <span class=\\\"pl-k\\\">void</span> <span class=\\\"pl-en\\\">admin_role_ok</span>() {</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L38\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"38\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC38\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">        resourceResolver<span class=\\\"pl-k\\\">.</span>securedResourceAdmin();</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L39\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"39\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC39\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">    }</td>\\n      </tr>\\n      <tr>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-L40\\\" class=\\\"blob-num js-line-number\\\" data-line-number=\\\"40\\\"></td>\\n        <td id=\\\"file-springgraphqlsecurityapplicationtests-java-LC40\\\" class=\\\"blob-code blob-code-inner js-file-line\\\">}</td>\\n      </tr>\\n</table>\\n\\n\\n  </div>\\n\\n  </div>\\n</div>\\n\\n      </div>\\n      <div class=\\\"gist-meta\\\">\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277/raw/1e4028117048abf0da904d60279ba98d1a815929/SpringGraphqlSecurityApplicationTests.java\\\" style=\\\"float:right\\\">view raw</a>\\n        <a href=\\\"https://gist.github.com/michalgebauer/5efb8d0d588b4ea3960759ed050ac277#file-springgraphqlsecurityapplicationtests-java\\\">SpringGraphqlSecurityApplicationTests.java</a>\\n        hosted with &#10084; by <a href=\\\"https://github.com\\\">GitHub</a>\\n      </div>\\n    </div>\\n</div>\\n</p>\\n<br />\\n<p>You can find full working example in my github repository:\\n<a href=\\\"https://github.com/michalgebauer/spring-graphql-security\\\">spring-graphql-security</a>.</p>\\n<p>Thank you for reading.</p>\",\"excerpt\":\"As I wrote in my previous post ( How GraphQL beats REST when I am hungry ) GraphQL has only one…\",\"frontmatter\":{\"date\":\"November 05, 2018\",\"path\":\"/spring-graphql-security\",\"title\":\"Secure your GraphQL with Spring AOP\",\"label\":[\"Spring\",\"java\",\"Spring boot\",\"Spring Security\",\"AOP\",\"GraphQL\",\"graphql-spring-boot-starter\",\"graphql-java-tools\",\"com.graphql-java\"],\"author\":\"Michal Gebauer\",\"type\":\"blog\",\"image\":{\"publicURL\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3.png\",\"childImageSharp\":{\"sizes\":{\"base64\":\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAIAAAAcOLh5AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAqklEQVQI1z3MuQqFMBQEUD9QLMRO00pqsbAKBgI2LmjhgiCJG4ji0ihByLd5i8drppk5ox3Hcd+3Uup9X85527bTND3PI6W8rmtd177v67qO45gQ4nme67q2bVuWZRiGtizLvu8wAlYURZZlURSN47ht23me0AohAKdpGoah7/sYY4TQDw/DUFVVnueMMUppEASQ8NU0DVzM89x1XVmWSZL8seM4pmnquv4Bj2ljZKU0Xj8AAAAASUVORK5CYII=\",\"aspectRatio\":5.91156462585034,\"src\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3-b739c.png\",\"srcSet\":\"/static/security-8dd7ec3473cc559da9e1a96665adfed3-81691.png 310w,\\n/static/security-8dd7ec3473cc559da9e1a96665adfed3-4d50e.png 620w,\\n/static/security-8dd7ec3473cc559da9e1a96665adfed3-b739c.png 869w\",\"sizes\":\"(max-width: 869px) 100vw, 869px\"}}}}}},\"pathContext\":{}}\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./~/json-loader!./.cache/json/spring-graphql-security.json\n// module id = 378\n// module chunks = 172168835046748"],"sourceRoot":""}